{% load static %}
{% load util_tags  %}
{% load template_tags %}

{% block content %}
<table class="table table-hover text-center" id="filtertable">
    <thead class=" ">
        <tr>
            {% comment %} <th scope="col">S. No.</th> {% endcomment %}
            <th scope="col">Username</th>
            <th scope="col">Email</th>
            <th scope="col">Contact</th>
            <th scope="col">Status</th>
            <th scope="col">Credits</th>
            {% if perms.customer.view or perms.customer.update_email or perms.credits.assign_customer %}
            <th scope="col">Action</th>
            {% endif %}
        </tr>
    </thead>
    <tbody class="bg-white">
        {% for user in list %}
        <tr>
            {% comment %} <th scope="row">{{forloop.counter}}</th> {% endcomment %}
            
            <td>{{user.first_name}} {{user.last_name}}</td>
            <td>{{user.email}}</td>
            <td>{{user.contact}}</td>
            <td>
                {% if perms.customer.approve %}
                    {% if user.verification_status == "waiting for approval" %}
                    waiting for approval
                    {% elif user.verification_status == "rejected" %}
                    <span class="text-danger">Rejected</span>
                    {% elif user.verification_status == "updated" %}
                    <span class="text-warning">Documents updated</span>
                    {% elif user.verification_status == "active" %}
                    <a href="{% url 'wayrem_admin:customer_verification' user.id %}?status=inactive"
                        class="btn-sm text-success"><i class="fas fa-toggle-on text-success"> Active</i></a> 
                        {% else %}
                        <a href="{% url 'wayrem_admin:customer_verification' user.id %}?status=active" class="btn-sm text-danger"><i
                            class="fas fa-toggle-off"> Inactive</i></a>
                    {% endif %}
                    {% else %}
                    No Permission
                {% endif %}
            </td>
            <td>
                {% if user.creditmanagement_set.first %}
                    {{user.creditmanagement_set.first.credit_rule.credit_amount}}
                {% else %}
                Not Assigned
                {% endif %}
            </td>
            {% comment %} href="{% url 'wayrem_admin:customerdetails' user.id %}" {% endcomment %}
                <!-- <a type="button" class="btn btn-sm " data-bs-toggle="modal" data-bs-target="#customerModal{{user.id}}" >
                        <i class="mx-1 fas fa-eye text-success" style="font-size:15px;"></i>
                    </a> -->
            {% if perms.customer.view or perms.customer.update_email or perms.credits.assign_customer %}
            <td>
                <div class="btn-group">
                    <button class="btn btn-link text-dark dropdown-toggle dropdown-toggle-split m-0 p-0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="icon icon-sm">
                            <span class="fas fa-ellipsis-h icon-dark"></span>
                        </span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                    <div class="dropdown-menu">
                        {% if perms.customer.view %}
                        <a class="dropdown-item" href="{% url 'wayrem_admin:customerdetails' user.id %}"><span class="fas fa-eye mr-2"></span>View Details</a>
                        {% endif %}
                        {% if perms.customer.update_email %}
                        <a class="dropdown-item" href="{% url 'wayrem_admin:customer_email_update' user.id %}"><span class="fas fa-edit mr-2"></span>Update Email</a>
                        {% endif %}
                        {% if perms.credits.assign_customer %}
                        <a class="dropdown-item" href="{% url 'wayrem_admin:assign_credit' user.id %}"><span class="fa fa-credit-card mr-2"></span>Update Credit</a>
                        {% endif %}
                        {% comment %} <a class="dropdown-item" href=""><span class="fas fa-edit mr-2"></span>Edit</a>
                        <a class="dropdown-item text-danger"  data-bs-toggle="modal" data-bs-target="#deleteModal{{suppl.id}}" href="#"> <span class="fas fa-trash-alt mr-2"></span>Remove</a> {% endcomment %}
                    </div>
                </div>
            </td>    
            {% endif %}        
        </tr>
        {% endfor %}

    </tbody>
</table>
{% endblock content %}