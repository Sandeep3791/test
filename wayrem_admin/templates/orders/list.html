{% extends "layouts/base.html" %}
{% load static  %}
{% block title %} Orders {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}
{% block head %}
<link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
{% endblock head %}
{% block content %}
<div class="dashboard_content_inner">
    <div class="topbar_pages">
        <h4 class="text-title">Orders</h2>
        <div class="breadcrumb-section">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb padding-left-0">
                    <li class="breadcrumb-item"><a href="{% url 'wayrem_admin:dashboard' %}"><span class="sidebar-icon"><span class="fas fa-chart-pie"></span></span> Dashboard</a></li>
                    <li class="breadcrumb-item active" aria-current="page"> Orders</li>
                </ol>
            </nav>
        </div>
    </div>
    <div class="table-settings mb-4">
        <div class="subheader row align-items-center justify-content-between">
            <div class="col-xl-8 col-lg-8 col-12">
                <div class="col-xl-3 col-lg-3 col-md-3">
                </div>
            </div>
            <div class="col-xl-4 col-lg-4 col-12 my-2">
                <div class="row d-flex align-items-center">
                    <div class="col-xl-12 col-lg-3 col-md-0 mb-3 mb-md-0 mb-sm-3 mb-lg-0 " style="height:40px;">
                        <div class="input-group subadmin_search">
                            <span class="input-group-text" id="basic-addon2"><span class="fas fa-search"></span></span>
                            <input type="text" class="form-control table_searchbar" id="table_search" placeholder="Search" aria-label="Search" aria-describedby="basic-addon2">
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
    
    <div class="alert-container"></div>
    {% if messages %}
    {% for message in messages %}
    <div {% if message.tags %} class="alert alert-{{message.tags}} alert-dismissible fade show" {% endif %} role="alert">
        <strong> {{ message }}!</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
    {% endif %}
    <div class="card card-body border-light shadow-sm table-wrapper table-responsive pt-0">
        {% include "orders/grid_orders.html" %} 
        {% include "orders/pagination.html" %}    
    </div>

    <div class="modal fade" id="orderpopup" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Update User Shift</h5>
                </div>
                <div class="modal-body"></div>
            </div>     
        </div>
    </div>
    
</div>


{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
  
  <script> 
    $(document).ready(function(){
        $('.orderstatus').click(function(){
            order_status_id=$(this).data("id");
            var url="/orders/updateorderstatus/"+order_status_id;
            $.ajax({
                url: url,
                type: 'GET',
                cache: false,
                success: function(data) {
                    $('#orderpopup').modal('show');
                    $("#orderpopup").html(data);
                }
            })
            
        })

    })   

$("#orderpopup").on("click",".order_submit_success",function(e){
         url = $("#orderpopup #oderform").attr("action")
		 type_form=$("#orderpopup #oderform").attr("method")
	   	 data_ser=$("#orderpopup #oderform").serialize()
         order_status_id=$(this).data("id");
         $.ajax({
	            type: type_form,
	            url: url,
	            data: data_ser,
	            cache: false,
	            success: function (data) {
                     $('#orderpopup').modal('hide');
                     $(".status_"+order_status_id).html(data);
                     var alert_message='<div class="alert-container alert alert-success alert-dismissible fade show" role="alert" ><strong> Order status Updated!!</strong><button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>';
                     $(".alert-container").html(alert_message);   
                     
                }
         })

    })
</script>
{% endblock javascripts %}